{
  "$schema": "../schemas/stylestack-config.json",
  "metadata": {
    "name": "Modern Typography Engine",
    "version": "1.0.0",
    "description": "Advanced typography configuration with modern kerning, OpenType features, and professional text styling",
    "inspired_by": "Open XML PowerTools methodology",
    "target_formats": [
      "potx",
      "dotx",
      "xltx"
    ]
  },
  "fonts": {
    "primary": {
      "display": {
        "family": "Inter",
        "fallbacks": [
          "SF Pro Display",
          "Segoe UI Variable",
          "system-ui",
          "Arial"
        ],
        "weights": [
          100,
          200,
          300,
          400,
          500,
          600,
          700,
          800,
          900
        ],
        "opentype_features": [
          {
            "kern": true
          },
          {
            "liga": true
          },
          {
            "calt": true
          },
          {
            "ss01": true
          },
          {
            "tnum": false
          },
          {
            "case": true
          }
        ]
      },
      "body": {
        "family": "Inter",
        "fallbacks": [
          "SF Pro Text",
          "Segoe UI",
          "system-ui",
          "Arial"
        ],
        "weights": [
          300,
          400,
          500,
          600,
          700
        ],
        "opentype_features": [
          {
            "kern": true
          },
          {
            "liga": true
          },
          {
            "calt": true
          },
          {
            "tnum": true
          },
          {
            "onum": false
          }
        ]
      },
      "monospace": {
        "family": "JetBrains Mono",
        "fallbacks": [
          "SF Mono",
          "Consolas",
          "Monaco",
          "Courier New"
        ],
        "weights": [
          200,
          300,
          400,
          500,
          600,
          700,
          800
        ],
        "opentype_features": [
          {
            "kern": true
          },
          {
            "liga": true
          },
          {
            "calt": true
          },
          {
            "zero": true
          },
          {
            "ss02": true
          }
        ]
      }
    }
  },
  "kerning": {
    "global": {
      "enabled": true,
      "method": "optical",
      "strength": 0.02
    },
    "pairs": {
      "AV": -0.08,
      "AW": -0.06,
      "AY": -0.08,
      "AT": -0.04,
      "VA": -0.08,
      "WA": -0.06,
      "YA": -0.08,
      "TA": -0.04,
      "T,": -0.06,
      "T.": -0.06,
      "P,": -0.04,
      "P.": -0.04,
      "F,": -0.04,
      "F.": -0.04,
      "\"A": -0.03,
      "\"T": -0.02,
      "A\"": -0.03,
      "T\"": -0.02
    },
    "size_scaling": {
      "small_text": {
        "scale": 1.2
      },
      "body_text": {
        "scale": 1.0
      },
      "display_text": {
        "scale": 0.8
      }
    }
  },
  "spacing": {
    "baseline_grid": "6pt",
    "leading": {
      "method": "proportional",
      "ratios": {
        "display": 1.2,
        "body": 1.5,
        "caption": 1.4
      }
    },
    "paragraphs": {
      "space_before": "0.5em",
      "space_after": "0.75em",
      "first_line_indent": "0em",
      "widow_control": true,
      "orphan_control": true
    },
    "tracking": {
      "display_tight": "-0.02em",
      "display_normal": "-0.01em",
      "body_normal": "0em",
      "body_loose": "0.01em",
      "all_caps": "0.08em",
      "small_caps": "0.05em"
    }
  },
  "type_scale": {
    "scale_ratio": 1.25,
    "base_size": "16pt",
    "sizes": {
      "xs": "10.24pt",
      "sm": "12.8pt",
      "base": "16pt",
      "lg": "20pt",
      "xl": "25pt",
      "2xl": "31.25pt",
      "3xl": "39.06pt",
      "4xl": "48.83pt",
      "5xl": "61.04pt"
    },
    "semantic": {
      "body": "base",
      "caption": "sm",
      "footnote": "xs",
      "subhead": "lg",
      "headline": "2xl",
      "display": "4xl",
      "hero": "5xl"
    }
  },
  "opentype": {
    "global_features": {
      "kern": true,
      "liga": true,
      "clig": true,
      "dlig": false,
      "hlig": false
    },
    "numbers": {
      "default": "proportional_lining",
      "tabular_contexts": [
        "tables",
        "code",
        "financial"
      ],
      "oldstyle_contexts": [
        "body_text",
        "captions"
      ]
    },
    "stylistic_sets": {
      "ss01": false,
      "ss02": false,
      "ss03": false
    },
    "case_sensitive": {
      "enabled": true,
      "contexts": [
        "all_caps",
        "small_caps",
        "acronyms"
      ]
    }
  },
  "powerpoint": {
    "slide_masters": {
      "title_slide": {
        "title": {
          "font": "{fonts.primary.display}",
          "size": "{type_scale.sizes.4xl}",
          "weight": 700,
          "tracking": "{spacing.tracking.display_tight}",
          "leading": "{spacing.leading.ratios.display}"
        },
        "subtitle": {
          "font": "{fonts.primary.body}",
          "size": "{type_scale.sizes.xl}",
          "weight": 400,
          "tracking": "{spacing.tracking.body_normal}",
          "leading": "{spacing.leading.ratios.body}"
        }
      },
      "content_slide": {
        "title": {
          "font": "{fonts.primary.display}",
          "size": "{type_scale.sizes.2xl}",
          "weight": 600,
          "tracking": "{spacing.tracking.display_normal}"
        },
        "body": {
          "font": "{fonts.primary.body}",
          "size": "{type_scale.sizes.base}",
          "weight": 400,
          "tracking": "{spacing.tracking.body_normal}",
          "leading": "{spacing.leading.ratios.body}"
        },
        "bullets": {
          "indent": "1em",
          "spacing": "0.25em",
          "hierarchy_scaling": 0.9
        }
      }
    }
  },
  "word": {
    "styles": {
      "normal": {
        "font": "{fonts.primary.body}",
        "size": "{type_scale.sizes.base}",
        "weight": 400,
        "leading": "{spacing.leading.ratios.body}",
        "paragraph_spacing": {
          "before": "{spacing.paragraphs.space_before}",
          "after": "{spacing.paragraphs.space_after}"
        }
      },
      "heading_1": {
        "font": "{fonts.primary.display}",
        "size": "{type_scale.sizes.3xl}",
        "weight": 700,
        "tracking": "{spacing.tracking.display_tight}",
        "leading": "{spacing.leading.ratios.display}",
        "space_before": "1.5em",
        "space_after": "0.5em"
      },
      "heading_2": {
        "font": "{fonts.primary.display}",
        "size": "{type_scale.sizes.2xl}",
        "weight": 600,
        "tracking": "{spacing.tracking.display_normal}"
      },
      "heading_3": {
        "font": "{fonts.primary.display}",
        "size": "{type_scale.sizes.xl}",
        "weight": 600
      },
      "quote": {
        "font": "{fonts.primary.body}",
        "size": "{type_scale.sizes.lg}",
        "style": "italic",
        "tracking": "{spacing.tracking.body_loose}",
        "indent": "2em"
      },
      "code": {
        "font": "{fonts.monospace}",
        "size": "{type_scale.sizes.sm}",
        "background": "#f8f9fa",
        "padding": "0.2em 0.4em"
      }
    }
  },
  "excel": {
    "cell_styles": {
      "normal": {
        "font": "{fonts.primary.body}",
        "size": "11pt",
        "number_format": "proportional_lining"
      },
      "header": {
        "font": "{fonts.primary.display}",
        "size": "12pt",
        "weight": 600
      },
      "data": {
        "font": "{fonts.primary.body}",
        "size": "11pt",
        "number_format": "tabular_lining"
      },
      "currency": {
        "font": "{fonts.primary.body}",
        "size": "11pt",
        "number_format": "tabular_lining",
        "decimal_places": 2
      }
    }
  },
  "accessibility": {
    "contrast": {
      "minimum_ratio": 4.5,
      "preferred_ratio": 7.0
    },
    "line_length": {
      "min_characters": 45,
      "max_characters": 75,
      "optimal_characters": 65
    },
    "dyslexia_support": {
      "increased_spacing": 1.2,
      "no_justified_text": true,
      "avoid_italics_in_body": true
    }
  },
  "i18n": {
    "cjk": {
      "fonts": {
        "primary": "Source Han Sans",
        "fallback": "Arial Unicode MS"
      },
      "line_height": 1.7,
      "letter_spacing": "0.05em"
    },
    "arabic": {
      "fonts": {
        "primary": "Noto Sans Arabic",
        "fallback": "Arial"
      },
      "direction": "rtl",
      "line_height": 1.6
    },
    "european": {
      "increased_line_height": 1.6
    }
  },
  "ooxml_targets": {
    "presentation": {
      "slide_masters": [
        {
          "file": "ppt/slideMasters/slideMaster1.xml",
          "transforms": [
            {
              "xpath": "//a:latin/@typeface",
              "value": "{fonts.primary.display.family}"
            },
            {
              "xpath": "//a:defRPr/@sz",
              "value": "{type_scale.base_size_twentieths}",
              "description": "Font size in twentieths of a point"
            },
            {
              "xpath": "//a:defRPr/@kern",
              "value": "{kerning.global.strength_twentieths}",
              "description": "Kerning in twentieths of a point"
            }
          ]
        }
      ],
      "theme": [
        {
          "file": "ppt/theme/theme1.xml",
          "transforms": [
            {
              "xpath": "//a:majorFont/a:latin/@typeface",
              "value": "{fonts.primary.display.family}"
            },
            {
              "xpath": "//a:minorFont/a:latin/@typeface",
              "value": "{fonts.primary.body.family}"
            }
          ]
        }
      ]
    },
    "document": {
      "styles": [
        {
          "file": "word/styles.xml",
          "transforms": [
            {
              "xpath": "//w:rFonts/@w:ascii",
              "value": "{fonts.primary.body.family}"
            },
            {
              "xpath": "//w:sz/@w:val",
              "value": "{type_scale.base_size_half_points}",
              "description": "Font size in half-points"
            },
            {
              "xpath": "//w:spacing/@w:val",
              "value": "{spacing.leading.body_twips}",
              "description": "Line spacing in twips"
            }
          ]
        }
      ]
    }
  },
  "optimization": {
    "font_subsetting": {
      "enabled": true,
      "include_unicode_ranges": [
        "U+0020-007F",
        "U+00A0-00FF",
        "U+0100-017F"
      ]
    },
    "kerning_optimization": {
      "skip_pairs_under": 0.01,
      "combine_similar_pairs": true
    },
    "fallback_strategy": {
      "no_opentype": "disable_advanced_features",
      "old_office": "use_basic_kerning_only",
      "web_fonts": "progressive_enhancement"
    }
  },
  "validation": {
    "checks": [
      {
        "name": "font_availability",
        "description": "Ensure primary fonts are available",
        "critical": true
      },
      {
        "name": "kerning_pairs_valid",
        "description": "Validate kerning pair syntax",
        "critical": true
      },
      {
        "name": "accessibility_compliance",
        "description": "Check WCAG contrast ratios",
        "critical": false
      },
      {
        "name": "character_support",
        "description": "Verify Unicode coverage",
        "critical": false
      }
    ],
    "ooxml_validation": {
      "schema_compliance": true,
      "relationship_integrity": true,
      "font_embedding_check": true
    }
  },
  "build_config": {
    "preprocessing": [
      "calculate_twentieths_values",
      "calculate_twips_values",
      "resolve_font_fallbacks",
      "validate_unicode_coverage"
    ],
    "postprocessing": [
      "embed_fonts_if_requested",
      "optimize_kerning_tables",
      "validate_output_quality",
      "generate_typography_report"
    ]
  },
  "computed_values": {
    "type_scale": {
      "base_size_twentieths": 320,
      "base_size_half_points": 32
    },
    "spacing": {
      "leading": {
        "body_twips": 360
      }
    },
    "kerning": {
      "global": {
        "strength_twentieths": 6.4
      }
    }
  }
}